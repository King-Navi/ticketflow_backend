PasswordForgotRequest:
  type: object
  additionalProperties: false
  required: [email]
  properties:
    email:
      type: string
      format: email
      maxLength: 100
      examples: ["alice@example.com"]

PasswordForgotResponse:
  type: object
  required: [message]
  properties:
    message:
      type: string
      example: "If the email exists, a password reset link will be sent."

PasswordResetValidateResponse:
  type: object
  required: [message, credential_id, password_reset_token_id]
  properties:
    message:
      type: string
      example: "Token is valid."
    credential_id:
      type: integer
      example: 12
    password_reset_token_id:
      type: integer
      example: 45

PasswordResetRequest:
  type: object
  additionalProperties: false
  required: [token, newPassword]
  properties:
    token:
      type: string
      minLength: 10
      maxLength: 300
      example: "YkqKqK7eQv9YbAq3..."
    newPassword:
      type: string
      minLength: 8
      maxLength: 255
      example: "NewStrongPass123!"

PasswordResetSuccessResponse:
  type: object
  required: [message]
  properties:
    message:
      type: string
      example: "Password updated successfully."

BodyValidationError:
  type: object
  required: [status, message]
  properties:
    status:
      type: string
      example: "BadRequest"
    message:
      type: string
      example: "\"email\" is required"

QueryValidationError:
  type: object
  required: [message, details]
  properties:
    message:
      type: string
      example: "Validation error"
    details:
      type: array
      items:
        type: object
        properties:
          message:
            type: string
          path:
            type: array
            items:
              type: string
      example:
        - message: "\"token\" is required"
          path: ["token"]

TokenInvalidError:
  type: object
  required: [message]
  properties:
    message:
      type: string
      example: "Invalid or expired token."

TokenRequiredError:
  type: object
  required: [message]
  properties:
    message:
      type: string
      example: "token and newPassword are required."

ServerError:
  type: object
  required: [message]
  properties:
    message:
      type: string
      example: "Error resetting password."
