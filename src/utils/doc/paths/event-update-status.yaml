patch:
  summary: Update event status
  description: >
    Updates the status of an event. Only the organizer (from the same company as the event)
    or an admin can change the status. The organizer is taken from the authenticated user
    (req.user.credential_id or req.user.sub).
  tags:
    - Event
  security:
    - bearerAuth: []
  parameters:
    - name: eventId
      in: path
      required: true
      description: Event identifier
      schema:
        type: integer
  requestBody:
    required: true
    description: New status for the event. It can be a numeric status id or a string code.
    content:
      application/json:
        schema:
          type: object
          required:
            - status
          properties:
            status:
              oneOf:
                - type: integer
                  description: Numeric status id
                  example: 2
                - type: string
                  description: Status code
                  example: on_sale
  responses:
    "200":
      description: Event status updated successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Event status updated successfully.
              event:
                $ref: "../schemas/event.yaml#/Event"
          examples:
            success:
              summary: Example successful response
              value:
                message: "Event status updated successfully."
                event:
                  event_id: 1
                  event_name: "AI & Data Summit 2026"
                  category: "Technology"
                  description: "Cumbre internacional que reunirá a expertos en IA, MLOps y plataformas de datos para compartir casos de uso, mejores prácticas y tendencias que impulsan la innovación empresarial. (196 caracteres)"
                  event_date: "2025-11-10"
                  start_time: "10:30:00"
                  end_time: "18:00:00"
                  company_id: 2
                  event_location_id: 1
                  event_status_id: 3
                  created_at: "2025-11-13T03:18:28.288Z"
                  updated_at: "2025-11-13T08:56:12.876Z"
    "400":
      description: Bad request (invalid status or body)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    "401":
      description: Unauthorized (missing/invalid token or organizer not found)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    "403":
      description: Forbidden (role not allowed)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    "404":
      description: Event not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    "409":
      description: Conflict (conflict from service/repo)
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: This location is already booked for that time range.
              details:
                type: object
                additionalProperties: true
    "500":
      description: Server error updating event status
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Error:
      type: object
      properties:
        message:
          type: string
          example: Error updating event status.
