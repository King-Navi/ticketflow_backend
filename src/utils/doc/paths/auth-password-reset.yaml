post:
  tags: [Auth]
  summary: Reset password using a valid token
  description: >
    Consumes a valid password reset token and sets a new password.
    Marks the token as used and revokes other active tokens for the same credential.
  security: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: "../schemas/auth-password.yaml#/PasswordResetRequest"
        examples:
          valid:
            value:
              token: "YkqKqK7eQv9YbAq3..."
              newPassword: "NewStrongPass123!"
  responses:
    "200":
      description: Password reset successfully
      content:
        application/json:
          schema:
            $ref: "../schemas/auth-password.yaml#/PasswordResetSuccessResponse"
    "400":
      description: Body validation error (Joi) OR missing fields OR token invalid/expired.
      content:
        application/json:
          oneOf:
            - $ref: "../schemas/auth-password.yaml#/BodyValidationError"
            - $ref: "../schemas/auth-password.yaml#/TokenRequiredError"
            - $ref: "../schemas/auth-password.yaml#/TokenInvalidError"
    "500":
      description: Unexpected server error while resetting the password
      content:
        application/json:
          schema:
            $ref: "../schemas/auth-password.yaml#/ServerError"
