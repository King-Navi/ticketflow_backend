get:
  tags: [Auth]
  summary: Validate password reset token
  description: >
    Validates that the provided token exists, has not expired and has not been used.
    Returns 200 if valid, 400 if invalid/expired or if the query is invalid.
  security: []
  parameters:
    - in: query
      name: token
      required: true
      schema:
        type: string
        minLength: 10
        maxLength: 300
      description: Raw token received in the email link.
  responses:
    "200":
      description: Token is valid
      content:
        application/json:
          schema:
            $ref: "../schemas/auth-password.yaml#/PasswordResetValidateResponse"
    "400":
      description: Either validation error (Joi) OR token is invalid/expired.
      content:
        application/json:
          oneOf:
            - $ref: "../schemas/auth-password.yaml#/QueryValidationError"
            - $ref: "../schemas/auth-password.yaml#/TokenInvalidError"
    "500":
      description: Unexpected server error
      content:
        application/json:
          schema:
            $ref: "../schemas/auth-password.yaml#/ServerError"
